00010	C
00020	C      BUDGET PROGRAM
00030	C
00040	C   THIS PROGRAM TAKES AS DATA THE BUDGET IN DATA CARD FREE
00050	C      FORMAT (SEE DOCUMENTATION), SETS UP AN INTERNAL
00060	C      REPRESENTATION FOR EACH ITEM AND THEN ALLOWS THE USER
00070	C      TO OBTAIN A BUDGET FOR THE CURRENT OR SUBSEQUENT
00080	C      YEARS.
00090	C
00100	C   IT IS BASICALLY SPLIT INTO THREE SECTIONS: INPUT,COMMAND
00110	C      SCAN, AND PROCESSING-OUTPUT.
00120	C
00130	C*********************************************************************
00140	C
00150	      IMPLICIT INTEGER (A-N),REAL(O-Z)
00160	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
00170	      INTEGER OUNIT
00180	      INTEGER PN,QN,ZP
00190	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
00200	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
00210	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
00220	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
00230	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
00240	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
00250	      INTEGER*4 T0
00260	C
00270	C
00280	      CTYP=0
00290	      DP=0
00300	      QN=0
00310	      ZP=0
00320	      PN=0
00330	      IZR=0
00340	      KEND=0
00350	      KSTRT=0
00360	      OUNIT=5
00370	      IOUNIT=5
00380	      CALL CLCRD
00390	      TYPE 1000
00400	 1000 FORMAT(1H ,'LONG OR SHORT FORM OUTPUT (L OR S)')
00410	      ACCEPT 1001,KSHRT
00420	 1001 FORMAT(A1)
00430	      DATA HL/1HL/
00440	      IF (KSHRT.EQ.HL) KSHRT=0
00450	      KTFLD=55
00460	      KAFLD=30
00470	      KBFLD=25
00480	      IF (KSHRT.EQ.0) GO TO 1002
00490	      KSHRT=1
00500	      KTFLD=45
00510	      KAFLD=23
00520	      KBFLD=22
00530	 1002 CONTINUE
00540	C
00550	C
00560	C***********************************************************************
00570	C
00580	C   PROCESS NEXT INPUT CARD
00590	C
00600	      IUNIT=20
00610	      TYPE110
00620	  110 FORMAT(' NAME THE BUDGET DATA FILE:')
00630	      OPEN(UNIT=20,ACCESS='SEQIN',MODE='ASCII',DIALOG)
00640	 100  IF (IUNIT.EQ.5) GO TO 500
00650	 102  CALL RDLIN
00660	      IF (CTYP.GT.0) KDCT(CTYP)=1
00670	      IF (CMDN.EQ.0) GO TO 101
00680	      IF (CMDN.GT.NCMD) GO TO 900
00690	      GO TO (200,210,214,216,220,230,240,250,260,270,280,290,300,
00700	     1       310,320,330,340,310),CMDN
00710	 101  GO TO (400,900,420,430),CSTAT
00720	C
00730	C***********************************************************
00740	C
00750	C   PROCESS THE TITLE
00760	C
00770	 200  CSTAT=1
00780	      CTYP=0
00790	 400  IF (FLDC.EQ.0) GO TO 100
00800	      KTITP=FLD(1,1)
00810	      KTITL=FLD(1,2)
00820	      IF (KTITL.LT.-1) GO TO 900
00830	      GO TO 100
00840	C
00850	C      HANDLE DATES OF BUDGET
00860	C
00870	 210  CSTAT=2
00880	      IF (FLDC.EQ.0) GO TO 100
00890	      IF (FLDC.LT.4) GO TO 900
00900	 214  I=1
00910	      IF (FLD(I,2).NE.-2.OR.FLD(I+1,2).NE.-2) GO TO 900
00920	      KSTRT=IFIX(Z(FLD(I,1)))+100*MOD(IFIX(Z(FLD(I+1,1))),100)
00930	      KLEN=(KEND+88)/100-KSTRT/100
00940	      KMNTH=Z(FLD(I,1))
00950	      I=I+2
00960	 212  IF (FLD(I,2).EQ.-1) GO TO 100
00970	 213  IF (FLD(I,2).NE.-2.OR.FLD(I+1,2).NE.-2) GO TO 900
00980	      KEND=IFIX(Z(FLD(I,1)))+100*MOD(IFIX(Z(FLD(I+1,1))),100)
00990	      KLEN=(KEND+88)/100-KSTRT/100
01000	      GO TO 100
01010	 216  I=1
01020	      GO TO 213
01030	C
01040	C************************************************************
01050	C
01060	C   HANDLE PEOPLE
01070	C
01080	 220  CSTAT=3
01090	      CTYP=8
01100	      GO TO 100
01110	C
01120	 420  IF (FLDC.EQ.0) GO TO 100
01130	      PN=PN+1
01140	 421  IF (FLD(1,2).LT.-1) GO TO 900
01150	      P(PN,1)=FLD(1,1)
01160	      P(PN,2)=FLD(1,2)
01170	      P(PN,10)=0
01180	      IB=0
01190	      IF (FLD(1,2).NE.-1) GO TO 429
01200	      IF (PN.EQ.1) GO TO 900
01210	      IB=PN-1
01220	      P(PN,1)=P(IB,1)
01230	      P(PN,2)=P(IB,2)
01240	      P(PN,3)=P(IB,3)
01250	      P(PN,4)=P(IB,4)
01260	      P(PN,10)=IB
01270	 429  IF (FLD(I,2).LT.-1) GO TO 900
01280	      IF (IB.NE.0.AND.FLD(I,2).EQ.-1) GO TO 422
01290	      P(PN,3)=FLD(2,1)
01300	      P(PN,4)=FLD(2,2)
01310	 422  CALL NXARG(ZV,3,1,ER,WPDFT(5,IB,100.0))
01320	      IF (ER.NE.0) GO TO 900
01330	      P(PN,5)=ZV
01340	      CALL NXARG(ZV,4,1,ER,WPDFT(6,IB,-3333.0))
01350	      IF (ER.NE.0) GO TO 900
01360	      P(PN,6)=ZV
01370	      CALL NXARG(ZV,5,1,ER,WPDFT(7,IB,1.0))
01380	      IF (ER.NE.0) GO TO 900
01390	      P(PN,7)=ZV
01400	      T0=KLEN
01410	      CALL NXARG(ZV,6,1,ER,WPDFT(8,IB,FLOAT(T0)))
01420	      IF (ER.NE.0) GO TO 900
01430	      P(PN,8)=ZV
01440	      CALL NXARG(ZV,7,1,ER,WPDFT(9,IZR,9.0))
01450	      IF (ER.NE.0) GO TO 900
01460	      P(PN,9)=ZV
01470	      IF (IUNIT.NE.5.OR.IB.NE.0) GO TO 100
01480	      TYPE423,PN
01490	 423  FORMAT(1H ,5X,15HITEM NUMBER IS ,I2)
01500	      GO TO 500
01510	C
01520	C***********************************************************
01530	C
01540	C   HANDLE ITEMS OF BUDGET BESIDES PEOPLE
01550	C
01560	C
01570	C      CONSULTANT
01580	C
01590	 230  CSTAT=4
01600	      CTYP=1
01610	      GO TO 100
01620	C
01630	C      EQUIPMENT
01640	C
01650	 240  CSTAT=4
01660	      CTYP=2
01670	      GO TO 100
01680	C
01690	C      SUPPLIES
01700	C
01710	 250  CSTAT=4
01720	      CTYP=3
01730	      GO TO 100
01740	C
01750	C      TRAVEL
01760	C
01770	 260  CSTAT=4
01780	      CTYP=4
01790	      GO TO 100
01800	C
01810	C      PATIENT
01820	C
01830	 270  CSTAT=4
01840	      CTYP=5
01850	      GO TO 100
01860	C
01870	C      ALTERATIONS
01880	C
01890	 280  CSTAT=4
01900	      CTYP=6
01910	      GO TO 100
01920	C
01930	C      OTHER
01940	C
01950	 290  CSTAT=4
01960	      CTYP=7
01970	      GO TO 100
01980	C
01990	C      HANDLE NEXT ITEM
02000	C
02010	 430  IF (FLDC.EQ.0) GO TO 100
02020	      QN=QN+1
02030	 432  IF (FLD(I,2).LT.-1) GO TO 900
02040	      Q(QN,1)=FLD(1,1)
02050	      Q(QN,2)=FLD(1,2)
02060	      Q(QN,10)=0
02070	      IB=0
02080	      IF (FLD(I,2).NE.-1) GO TO 431
02090	      IF (QN.EQ.1) GO TO 900
02100	      IB=QN-1
02110	      Q(QN,1)=Q(IB,1)
02120	      Q(QN,2)=Q(IB,2)
02130	      Q(QN,10)=IB
02140	 431  Q(QN,3)=CTYP
02150	      Q(QN,9)=0.0
02160	      CALL NXARG(ZV,3,1,ER,WQDFT(6,IB,-3333.0))
02170	      IF (ER.NE.0) GO TO900
02180	      Q(QN,6)=ZV
02190	      CALL NXARG(ZV,2,1,ER,WQDFT(5,IB,1.0))
02200	      IF (ER.NE.0) GO TO 900
02210	      Q(QN,5)=ZV
02220	      CALL NXARG(ZV,4,1,ER,WQDFT(7,IB,1.0))
02230	      IF (ER.NE.0) GO TO 900
02240	       Q(QN,7)=ZV
02250	      T0=KLEN
02260	       CALL NXARG(ZV,5,1,ER,WQDFT(8,IB,FLOAT(T0)))
02270	       IF (ER.NE.0) GO TO 900
02280	      Q(QN,8)=ZV
02290	      IF (IUNIT.NE.5.OR.IB.NE.0) GO TO 100
02300	      IA=QN+100
02310	         TYPE433,IA
02320	 433  FORMAT(1H ,5X,15HITEM NUMBER IS ,I3)
02330	      GO TO 500
02340	C
02350	C***********************************************************
02360	C
02370	C
02380	C   ANUL-INC (ANNUAL INCREASE AS %)
02390	C
02400	 300  IF (FLDC.EQ.0.OR.CTYP.EQ.0) GO TO 900
02410	      T=0.0
02420	      IB=KLEN+1
02430	      DO 301 IA=1,IB
02440	      IF (FLD(IA,2).EQ.-1) GO TO 301
02450	      IF (FLD(IA,2).NE.-2) GO TO 900
02460	      T=Z(FLD(IA,1))
02470	 301  KINC(CTYP,IA)=T
02480	      GO TO 100
02490	C
02500	C   SAL-OVHD (SALARY OVERHEAD AS %)
02510	C      (ALIAS OF STAFF-BEN)
02520	C
02530	 310  IF (FLDC.EQ.0.OR.CSTAT.NE.3) GO TO 900
02540	      T=0.0
02550	      IB=KLEN+1
02560	      DO 311 IA=1,IB
02570	      IF (FLD(IA,2).EQ.-1) GO TO 311
02580	      IF (FLD(IA,2).NE.-2) GO TO 900
02590	      T=Z(FLD(IA,1))
02600	 311  KOVHD(IA)=T
02610	      GO TO 100
02620	C
02630	C   STAN-OVHD (STANFORD OVERHEAD AS %)
02640	C
02650	 320  IF (FLDC.EQ.0) GO TO 900
02660	      T=0.0
02670	      IB=KLEN+1
02680	      DO 321 IA=1,IB
02690	      IF (FLD(IA,2).EQ.-1) GO TO 321
02700	      IF (FLD(IA,2).NE.-2) GO TO 900
02710	      T=Z(FLD(IA,1))
02720	 321  KSO(IA)=T
02730	      GO TO 100
02740	C
02750	C   END (END OF LOAD)
02760	C
02770	 330  IUNIT=5
02780	      ADDFG=0
02790	      IZP=0
02800	      IDP=0
02810	      CLOSE(UNIT=20)
02820	      GO TO 500
02830	C
02840	C   ROUND (ROUNDING VALUES)
02850	C
02860	 340  IF (FLDC.EQ.0) GO TO 900
02870	      IA=1
02880	      DO 341 IB=1,KLEN
02890	      IF (FLD(IB,2).EQ.-1) GO TO 341
02900	      IF (FLD(IB,2).NE.-2) GO TO 900
02910	      IA=Z(FLD(IB,1))
02920	 341  KRND(CTYP,IB)=IA
02930	      GO TO 100
02940	C
02950	C*************************************************************
02960	C
02970	C
02980	C   MAIN COMMAND INTERPRETER--TAKES COMMANDS FROM TTY AND OUTPUTS
02990	C      WHAT IS REQUESTED.
03000	C
03010	C
03020	 500  CONTINUE
03030	      IF (IZP.EQ.0) GO TO 509
03040	      ZP=IZP
03050	      DP=IDP
03060	 509  TYPE501
03070	 501  FORMAT(1H0,6HREADY )
03080	      IZP=ZP
03090	      IDP=DP
03100	      CALL RDLIN
03110	      IF (CMDN.EQ.0.AND.ADDFG.EQ.1) GO TO 522
03120	      ADDFG=0
03130	      CALL CLCRD
03140	      IF (CMDN.LT.20) GO TO 502
03150	      CMDN=CMDN-20
03160	      GO TO (510,520,530,540,550,560,570,580,590,600,
03170	     1       610,620,630,640),CMDN
03180	 502  TYPE503
03190	 503  FORMAT(1H ,15HILLEGAL COMMAND)
03200	      GO TO 500
03210	 504  TYPE505
03220	 505  FORMAT(1H ,23HILLEGAL OR NOT FOUND ID)
03230	      GO TO 500
03240	C
03250	C   REPLACE <ID>
03260	C
03270	 510  GO TO 530
03280	C
03290	C   ADD <ID>
03300	C
03310	 520  CALL FNDCAT(FLD(1,1),FLD(1,2),CTYP)
03320	 521  IF (CTYP.EQ.0) GO TO 504
03330	      CSTAT=4
03340	      IF (CTYP.EQ.8) CSTAT=3
03350	      IF (IZP.EQ.0) GO TO 523
03360	      ZP=IZP
03370	      DP=IDP
03380	      IZP=0
03390	 523  CALL RDLIN
03400	 522  ADDFG=1
03410	      IZP=0
03420	      IF (CMDN.NE.0.OR.FLDC.EQ.0) GO TO 502
03430	      IF (CSTAT-3) 420,420,430
03440	C
03450	C   DELETE <ID>
03460	C
03470	 530  CALL FNDID(IDN,CTYP)
03480	      IF (IDN.EQ.0) GO TO 502
03490	      IF (IDN.GT.100) GO TO 531
03500	      DO 532 IA=1,10
03510	 532  P(IDN,IA)=0
03520	      GO TO 534
03530	 531  DO 533 IA=1,10
03540	 533  Q(IDN-100,IA)=0
03550	 534  IF (CMDN-1) 500,521,500
03560	C
03570	C MODIFY <CAT>
03580	C
03590	 540  CALL FNDCAT(FLD(1,1),FLD(1,2),CTYP)
03600	      CSTAT=4
03610	      IF (CTYP.EQ.8) CSTAT=3
03620	      IF (IZP.EQ.0) GO TO 102
03630	      ZP=IZP
03640	      DP=IDP
03650	      IZP=0
03660	      GO TO 102
03670	C
03680	C   DETAIL <YR LIST>
03690	C
03700	 550  IA=0
03710	 551  IA=IA+1
03720	      IF (FLDC.LT.IA) GO TO 500
03730	      IF (FLD(IA,2).NE.-2) GO TO 502
03740	      IB=Z(FLD(IA,1))
03750	      IF (IB.LE.0.OR.IB.GT.KLEN) GO TO 502
03760	      CALL CMPCT
03770	      CALL DETAIL(IB)
03780	      GO TO 551
03790	C
03800	C   SUMMARY
03810	C
03820	 560  CALL SUMMRY(0)
03830	      GO TO 500
03840	C
03850	C   TOTAL <YEAR LIST>
03860	C
03870	 570  IA=0
03880	 571  IA=IA+1
03890	      IF (FLDC.LT.IA) GO TO 500
03900	      IF (FLD(IA,2).NE.-2) GO TO 502
03910	      IB=Z(FLD(IA,1))
03920	      IF (IB.LE.0.OR.IB.GT.KLEN) GO TO 502
03930	      CALL WORK(IB)
03940	      CALL TOTAL(IB,1)
03950	      GO TO 571
03960	C
03970	C   CATEGORY <CAT>,<YEAR LIST>
03980	C
03990	 580  CALL FNDCAT(FLD(1,1),FLD(1,2),ICT)
04000	      IF (ICT.EQ.0) GO TO 504
04010	      IA=1
04020	 581  IA=IA+1
04030	      IF (FLDC.LT.IA) GO TO 500
04040	      IF (FLD(IA,2).NE.-2) GO TO 502
04050	      IB=Z(FLD(IA,1))
04060	      IF (IB.LE.0.OR.IB.GT.KLEN) GO TO 502
04070	      CALL CATOUT(ICT,IB,1)
04080	      GO TO 581
04090	C
04100	C   ITEM <ID>,<YEAR LIST>
04110	C
04120	 590  CALL FNDID(IDN,ICT)
04130	      IF (IDN.EQ.0) GO TO 504
04140	      IA=1
04150	      IF (FLD(2,2).GE.0) IA=2
04160	 591  IA=IA+1
04170	      IF (FLDC.LT.IA) GO TO 500
04180	      IF (FLD(IA,2).NE.-2) GO TO 502
04190	      IB=Z(FLD(IA,1))
04200	      IF (IB.LE.0.OR.IB.GT.KLEN) GO TO 502
04210	      TO=1
04220	      IF (ICT.EQ.8) GO TO 592
04230	      IAA=IDN-100
04240	      CALL YRCOST(ICT,Q,400,10,IAA,XCY,T0,SO,IB,SLO)
04250	      GO TO 591
04260	 592  CALL YRCOST(ICT,P,100,10,IDN,XCY,T0,SO,IB,SLO)
04270	      GO TO 591
04280	C
04290	C   STOP
04300	C
04310	 600  TYPE601
04320	 601  FORMAT(/////)
04330	      PAUSE
04340	      GO TO 500
04350	C
04360	C   ALL
04370	C
04380	 610  CALL CMPCT
04390	      DO 611 I=1,KLEN
04400	 611  CALL DETAIL(I)
04410	      CALL SUMMRY(0)
04420	      IF (OUNIT.EQ.IOUNIT) GO TO 500
04430	      CLOSE(UNIT=OUNIT)
04440	      OUNIT=IOUNIT
04450	      GO TO 500
04460	      GO TO 500
04470	C
04480	C   SAVE
04490	C
04500	 620  CALL CMPCT
04510	      CALL SVDATA
04520	      GO TO 500
04530	C
04540	C   LIST
04550	C
04560	 630  OUNIT=23
04570	 632  TYPE631
04580	 631  FORMAT(1H ,'ENTER OUTPUT FILE NAME:')
04590	      OPEN(UNIT=OUNIT,ACCESS='SEQOUT',MODE='ASCII',DIALOG)
04600	      IF (CMDN.EQ.13) GO TO 610
04610	      IOUNIT=OUNIT
04620	      GOTO 500
04630	C
04640	C   DIVERT
04650	C
04660	 640  IF (OUNIT.EQ.5) GO TO 641
04670	      CLOSE(UNIT=OUNIT)
04680	      OUNIT=5
04690	      IOUNIT=5
04700	      GO TO 500
04710	 641  OUNIT=22
04720	      GO TO 632
04730	C
04740	C************************************************************
04750	C
04760	C   ERROR IN INPUT DATA
04770	C
04780	 900  TYPE901,(CRD(IA),IA=1,80)
04790	 901  FORMAT(1H0,13HERROR IN DATA/2X,80A1//)
04800	      IF (IUNIT.EQ.5) GO TO 500
04810	      STOP
04820	C
04830	C**********************************************************
04840	C
04850	C   END OF MAIN PROGRAM
04860	C
04870	      END
04880	      SUBROUTINE NXARG(ZV,I,IFG,IEFG,WDFT)
04890	      IMPLICIT INTEGER (A-N),REAL(O-Z)
04900	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
04910	      INTEGER OUNIT
04920	      INTEGER PN,QN,ZP
04930	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
04940	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
04950	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
04960	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
04970	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
04980	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
04990	      INTEGER*4 I,IFG
05000	C
05010	C   SUBROUTINE TO PROCESS NEXT ARG, USING ITS VALUE, OR DEFAULT
05020	C      AS APPROPRIATE, SYNTAX CHECKING, AND TYPE CHECKING
05030	C
05040	C
05050	      IEFG=0
05060	      IF (FLD(I,2).EQ.-2) GO TO 1
05070	      IF (FLD(I,2).NE.-1) GO TO 10
05080	      GO TO (2,10),IFG
05090	   2  IF (WDFT.EQ.-3333.0) GO TO 10
05100	      ZV=WDFT
05110	      RETURN
05120	  10  IEFG=1
05130	      RETURN
05140	   1  ZV=Z(FLD(I,1))
05150	      RETURN
05160	      END
05170	      FUNCTION WPDFT(I,IA,WV)
05180	      IMPLICIT INTEGER (A-N),REAL(O-Z)
05190	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
05200	      INTEGER OUNIT
05210	      INTEGER PN,QN,ZP
05220	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
05230	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
05240	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
05250	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
05260	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
05270	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
05280	      INTEGER*4 I
05290	C
05300	C   FUNCTION TO RETURN DEFAULT VALUE FOR PEOPLE GIVEN REAL DEFAULT
05310	C      AND BACKPOINTER IF ANY.
05320	C
05330	      WPDFT=WV
05340	      IF (IA.EQ.0) RETURN
05350	      WPDFT=P(IA,I)
05360	      RETURN
05370	      END
05380	      FUNCTION WQDFT(I,IA,WV)
05390	      IMPLICIT INTEGER (A-N),REAL(O-Z)
05400	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
05410	      INTEGER OUNIT
05420	      INTEGER PN,QN,ZP
05430	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
05440	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
05450	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
05460	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
05470	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
05480	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
05490	      INTEGER*4 I
05500	C
05510	C   FUNCTION TO RETURN DEFAULT VALUE FOR ITEM GIVEN REAL DEFAULT
05520	C      AND BACKPOINTER IF ANY
05530	C
05540	      WQDFT=WV
05550	      IF (IA.EQ.0) RETURN
05560	      WQDFT=Q(IA,I)
05570	      RETURN
05580	      END
05590	      SUBROUTINE RDLIN
05600	      IMPLICIT INTEGER (A-N),REAL(O-Z)
05610	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
05620	      INTEGER OUNIT
05630	      INTEGER PN,QN,ZP
05640	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
05650	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
05660	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
05670	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
05680	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
05690	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
05700	C
05710	C   THIS SUBROUTINE WILL READ ONE OR MORE PHYSICAL LINES TO
05720	C      GET AT ONE LOGICAL LINE. THE LINE IS READ FREE FORMAT
05730	C      AND IS SPLIT INTO FIELDS, OF EITHER ALPHAMERIC, INTEGER,
05740	C      OR REAL TYPE (OR NULL).
05750	C
05760	C
05770	      FLDC=0
05780	      ZP=0
05790	      DO 1 I=1,20
05800	      FLD(I,1)=0
05810	   1  FLD(I,2)=-1
05820	      CMDN=0
05830	      CLN=0
05840	      AR=1
05850	      GO TO 100
05860	C
05870	C      GET COMMAND IF PRESENT
05880	C
05890	   2  IG=NCMDS
05900	      IF (IUNIT.NE.5) IG=NCMD
05910	      DO 3 I=1,IG
05920	      IF (CMD(1,I).EQ.0) GO TO 3
05930	      DO 4 IA=1,8
05940	      C=1
05950	      IF (CMD(IA,I).EQ.0) GO TO 5
05960	      IF (CMD(IA,I).NE.CRD(IA)) GO TO 3
05970	   4  CONTINUE
05980	   5  CMDN=I
05990	   6  IF (C.GE.CLN) RETURN
06000	      IF (CRD(C).EQ.HCMA) GO TO 7
06010	      C=C+1
06020	      GO TO 6
06030	   3  CONTINUE
06040	      C=0
06050	C
06060	C      SCAN NEXT FIELD
06070	C
06080	   7  CP=0
06090	      AFG=0
06100	   8  C=C+1
06110	      IF (C.GT.CLN) GO TO 40
06120	      IF (CRD(C).EQ.HDIV.AND.C.NE.CLN.AND.CRD(C+1).EQ.HMUL) GO TO 50
06130	      IF (CRD(C).EQ.HCMA) GO TO 60
06140	      IF (CRD(C).EQ.HSP) GO TO 8
06150	      IF (CP.EQ.0) CP=C
06160	      IF (CRD(C).GE.H0.AND.CRD(C).LE.H9) GO TO 8
06170	      IF (CRD(C).NE.HDOT) AFG=1
06180	      GO TO 8
06190	C
06200	C      HANDLE END OF CRD
06210	C
06220	  40  CE=C-1
06230	      GO TO 200
06240	C
06250	C      HANDLE END OF FIELD
06260	C
06270	  60  CE=C-1
06280	      GO TO 200
06290	C
06300	C      HANDLE /*...*/ FIELD
06310	C
06320	  50  AFG=1
06330	      CP=C+2
06340	      C=C+2
06350	  53  IF (C.GT.CLN) GO TO 51
06360	      IF(CRD(C).EQ.HMUL.AND.C.NE.CLN.AND.CRD(C+1).EQ.HDIV) GO TO 52
06370	      C=C+1
06380	      GO TO 53
06390	  51  AR=2
06400	      GO TO 100
06410	  52  CE=C-1
06420	      C=C+1
06430	  55  C=C+1
06440	      IF (C.GT.CLN) GO TO 54
06450	      IF (CRD(C).EQ.HSP) GO TO 55
06460	      IF (CRD(C).NE.HCMA) GO TO 900
06470	  54  GO TO 200
06480	C
06490	C      ACTUALLY READ A CRD
06500	C
06510	 100  IA=CLN+1
06520	      IB=CLN+80
06530	      READ(IUNIT,101,END=105) (CRD(I),I=IA,IB)
06540	 101  FORMAT(80A1)
06550	      DO 102 IC=1,79
06560	      IB=IB-1
06570	      IF (CRD(IB).NE.HSP) GO TO 103
06580	 102  CONTINUE
06590	      GO TO 100
06600	 103  C=CLN+1
06610	      CLN=IB
06620	      DO 104 IC=IA,IB
06630	      IF (CRD(IC).LT.0) CRD(IC)=CRD(IC).AND."577777777777
06640	  104 CONTINUE
06650	      GO TO (2,53),AR
06660	 105  IF (AR.EQ.2) GO TO 900
06670	      CMDN=16
06680	      RETURN
06690	C
06700	C**************************************************************
06710	C
06720	C   PROCESS NEXT FIELD
06730	C
06740	 200  FLDC=FLDC+1
06750	      IF (CP.EQ.0) GO TO 290
06760	      IF (AFG.EQ.0) GO TO 210
06770	      FLD(FLDC,1)=DP+1
06780	      FLD(FLDC,2)=CE-CP+1
06790	      DO 201 I=CP,CE
06800	      DP=DP+1
06810	 201  DAT(DP)=CRD(I)
06820	      GO TO 290
06830	 210  X=0
06840	      IA=0
06850	      IE=0
06860	      ID=0
06870	      IB=CP-1
06880	 211  IB=IB+1
06890	      IF (IB.GT.CE) GO TO 220
06900	      IF (CRD(IB).NE.HDOT) GO TO 212
06910	      ID=1
06920	      GO TO 211
06930	 212  XA=FLOAT((CRD(IB)-H0)/(2**29))
06940	      X=X*10.+XA
06950	      IA=IA+1
06960	      IE=IE+ID
06970	      GO TO 211
06980	 220  ZP=ZP+1
06990	      Z(ZP)=X/(10.0**IE)
07000	      FLD(FLDC,1)=ZP
07010	      FLD(FLDC,2)=-2
07020	 290  IF (C.GT.CLN) RETURN
07030	      GO TO 7
07040	C
07050	C**************************************************************
07060	C
07070	C   HANDLE BAD CRDS
07080	C
07090	 900  TYPE901,(CRD(I),I=1,CLN)
07100	 901  FORMAT(1H1,19HERROR IN INPUT FILE//10(80A1/))
07110	      STOP
07120	      END
07130	      SUBROUTINE CMPCT
07140	      IMPLICIT INTEGER (A-N),REAL(O-Z)
07150	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
07160	      INTEGER OUNIT
07170	      INTEGER PN,QN,ZP
07180	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
07190	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
07200	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
07210	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
07220	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
07230	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
07240	C
07250	C   THIS ROUTINE COMPACTS THE P AND Q ARRAYS AND GIVES NEW ID NUMBERS
07260	C
07270	      CALL XCMPCT(P,100,10,PN,IA)
07280	      CALL XCMPCT(Q,400,10,QN,IB)
07290	      IF (IA+IB.EQ.0) RETURN
07300	      TYPE1
07310	   1  FORMAT(1H0,'WARNING:  ID NUMBERS CHANGED'//)
07320	      RETURN
07330	      END
07340	      SUBROUTINE XCMPCT(PQ,IPA,IPB,IPQN,IA)
07350	      IMPLICIT INTEGER (A-N),REAL(O-Z)
07360	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
07370	      INTEGER OUNIT
07380	      INTEGER PN,QN,ZP
07390	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
07400	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
07410	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
07420	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
07430	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
07440	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
07450	      INTEGER*4 IPA,IPB
07460	      DIMENSION PQ(IPA,IPB)
07470	C
07480	C   THIS ROUTINE DOES THE ACTUAL COMPACTING OF EITHER THE P OR THE Q
07490	C      ARRAY
07500	C
07510	      IA=0
07520	      IB=0
07530	   1  IB=IB+1
07540	      IF (IB.GT.IPQN) GO TO 10
07550	      IF (PQ(IB,1)+PQ(IB,3)+PQ(IB,5).EQ.0) GO TO 2
07560	      IF (IA.EQ.0) GO TO 1
07570	      DO 3 IC=1,10
07580	   3  PQ(IB-IA,IC)=PQ(IB,IC)
07590	      GO TO 1
07600	   2  IA=IA+1
07610	      GO TO 1
07620	  10  IF (IA.EQ.0) RETURN
07630	      IPQN=IPQN-IA
07640	      DO 11 IC=1,IA
07650	      DO 11 ID=1,10
07660	  11  PQ(IB-IC+1,ID)=0.0
07670	      RETURN
07680	      END
07690	      SUBROUTINE HEAD(IYR)
07700	      IMPLICIT INTEGER (A-N),REAL(O-Z)
07710	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
07720	      INTEGER OUNIT
07730	      INTEGER PN,QN,ZP
07740	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
07750	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
07760	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
07770	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
07780	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
07790	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
07800	      INTEGER*4 T0
07810	C
07820	C   THIS ROUTINE TYPES A HEADING TO A BUDGET TABLE
07830	C
07840	      WRITE(OUNIT,1)
07850	1	FORMAT(1H1/)
07860	      CALL PSTR(KTITP,KTITL,1,80)
07870	      CALL PRCRD
07880	      T0=KSTRT
07890	      IM=MOD(T0,100)
07900	      IA=KSTRT/100+1900-1+IYR
07910	      IB=IA+1
07920	      WRITE(OUNIT,2)IYR,IM,IA,IM,IB
07930	   2  FORMAT(/1H ,15HBUDGET FOR YEAR,I3,5X,4HFROM,I3,1H/,I4,2X,
07940	     1       2HTO,I3,1H/,I4///)
07950	      RETURN
07960	      END
07970	      SUBROUTINE YRCOST(ITYP,PQ,IPA,IPB,IZ,CY,PFG,SO,IYR,SLO)
07980	      IMPLICIT INTEGER (A-N),REAL(O-Z)
07990	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
08000	      INTEGER OUNIT
08010	      INTEGER PN,QN,ZP
08020	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
08030	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
08040	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
08050	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
08060	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
08070	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
08080	      REAL C,CY,CA,CC,PC,MN(12),CB,SCY,SC(12),AINT,SLO
08090	      INTEGER*4 IPA,IPB,PFG
08100	      INTEGER T0,T1
08110	      DIMENSION PQ(IPA,IPB)
08120	      ROUND(X,I)=AINT((X+I-0.5)/I)*I
08130	C
08140	C   THIS ROUTINE COMPUTES THE COST OF ITEM I OF TYPE ITYP IN THE ARRAY
08150	C      PQ(IPA,IPB) FOR THE YEAR IYR, RETURNING IT IN CY, THE
08160	C      STANFORD OVERHEAD IN SO.  THE LINE WILL BE TYPEED IF PFG
08170	C      IS NON-ZERO.
08180	C
08190	C
08200	      SO=0
08210	      CY=0
08220	      SLO=0
08230	      I=IZ
08240	   2  IF (PQ(I,7).LE.IYR.AND.PQ(I,8).GE.IYR) GO TO 1
08250	      I=I+1
08260	      IF (PQ(I,10).EQ.I-1) GO TO 2
08270	      RETURN
08280	   1  DO 3 IA=1,12
08290	   3  MN(IA)=0
08300	      IA=I
08310	   4  IF (PQ(IA,6).NE.0) GO TO 5
08320	      IA=PQ(IA,10)
08330	      IF (IA.NE.0) GO TO 4
08340	      IA=I
08350	   5  IB=IYR-PQ(IA,7)
08360	      IC=IB
08370	      PC=PQ(IA,6)
08380	      C=PC
08390	   7  IF (IB.EQ.0) GO TO 6
08400	      C=C*(1+KINC(ITYP,IYR-IB)/100.0)
08410	      IB=IB-1
08420	      GO TO 7
08430	   6  ID=PQ(IA,9)
08440	      IF (ID.EQ.0) ID=KMNTH
08450	      IF (IC.NE.0.AND.ITYP.EQ.8) ID=9
08460	      CA=C/12.0
08470	      CB=CA*KOVHD(IYR)/100.0
08480	      CC=0.0
08490	      IF (ITYP.NE.8) CB=0.0
08500	      IE=ID-KMNTH
08510	      CS=KSO(IYR)
08520	      IG=9-KMNTH+1
08530	      IF (IG.LE.0) IG=IG+12
08540	      IH=IG
08550	      IF (ITYP.NE.8) IG=20
08560	      IF (IE.LE.0) IE=IE+12
08570	      DO 18 IB=1,IE
08580	      IF (IG.EQ.IB) CB=CA*KOVHD(IYR+1)/100.0
08590	      IF (IH.EQ.IB) CS=KSO(IYR+1)
08600	      CC=CC+CA
08610	      MN(IB)=CA+CB
08620	  18  SC(IB)=MN(IB)*CS/100.0
08630	       IF (IE.EQ.12) GO TO9
08640	      IE=IE+1
08650	      CA=CA*KINC(ITYP,IYR)/100.0+CA
08660	      CB=CA*KOVHD(IYR)/100.0
08670	      IF (IG.LT.IE) CB=CA*KOVHD(IYR+1)/100.0
08680	      IF (ITYP.NE.8) CB=0.0
08690	      DO 8 IB=IE,12
08700	      IF (IG.EQ.IB) CB=CA*KOVHD(IYR+1)/100.0
08710	      IF (IH.EQ.IB) CS=KSO(IYR+1)
08720	      CC=CC+CA
08730	      MN(IB)=CA+CB
08740	   8  SC(IB)=MN(IB)*CS/100.0
08750	   9  IF (ITYP.NE.8) GO TO 10
08760	      DO 11 IB=1,12
08770	      MN(IB)=MN(IB)*PQ(I,5)/100
08780	      SC(IB)=SC(IB)*PQ(I,5)/100
08790	  11  CONTINUE
08800	      CC=CC*PQ(I,5)/100.0
08810	  10  CY=0
08820	      SCY=0.0
08830	      DO 12 IB=1,12
08840	      SCY=SCY+SC(IB)
08850	  12  CY=CY+MN(IB)
08860	      SCY=ROUND(SCY,KRND(ITYP,IYR))
08870	      CY=ROUND(CY,KRND(ITYP,IYR))
08880	      IF (PQ(I,5).EQ.0.OR.ITYP.EQ.2) GO TO 14
08890	  13  SO=SCY
08900	C
08910	C      TYPE DETAIL LINE
08920	C
08930	  14  IF (PFG.EQ.0) RETURN
08940	      T0=PQ(I,1)
08950	      T1=PQ(I,2)
08960	      IF (ITYP.EQ.8) GO TO 20
08970	      CALL PSTR(T0,T1,1,KTFLD+1)
08980	      IB=IZ+100
08990	      IF (KSHRT.NE.0) GO TO 51
09000	      WRITE(OUNIT,15)IB,(CRD(IX),IX=1,56),PQ(I,5),CY
09010	  15  FORMAT(1H ,I3,1X,56A1,F6.0,14X,F8.0)
09020	      GO TO 21
09030	  51  WRITE(OUNIT,1015)IB,(CRD(IX),IX=1,46),PQ(I,5),CY
09040	 1015 FORMAT(1H ,I3,1X,46A1,F6.0,14X,F8.0)
09050	      GO TO 21
09060	  20  CALL PSTR(T0,T1,1,KAFLD)
09070	      T0=PQ(I,3)
09080	      T1=PQ(I,4)
09090	      CALL PSTR(T0,T1,1+KAFLD,KBFLD)
09100	      SLO=CY-CC
09110	      IF (KSHRT.NE.0) GO TO 50
09120	      WRITE(OUNIT,17)IZ,(CRD(IX),IX=1,56),PQ(I,5),CC,SLO,CY
09130	  17  FORMAT(1H ,I3,1X,56A1,F4.0,2X,F6.0,2X,F6.0,F8.0)
09140	      GO TO 21
09150	  50  WRITE(OUNIT,1017)IZ,(CRD(IX),IX=1,46),PQ(I,5),CC,SLO,CY
09160	 1017 FORMAT(1H ,I3,1X,46A1,F4.0,2X,F6.0,2X,F6.0,F8.0)
09170	  21  IY=121
09180	  23  IF (CRMX.LT.IY) GO TO 24
09190	      IA=IY+KTFLD
09200	      WRITE(OUNIT,22)(CRD(IB),IB=IY,IA)
09210	  22  FORMAT(1H ,4X,56A1)
09220	      IY=IY+120
09230	      GO TO 23
09240	  24  CALL CLCRD
09250	      RETURN
09260	      END
09270	      SUBROUTINE DETAIL(IYR)
09280	      IMPLICIT INTEGER (A-N),REAL(O-Z)
09290	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
09300	      INTEGER OUNIT
09310	      INTEGER PN,QN,ZP
09320	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
09330	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
09340	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
09350	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
09360	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
09370	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
09380	C
09390	C   THIS ROUTINE TYPES THE DETAILED BUDGET FOR ONE YEAR
09400	C
09410	      CALL HEAD(IYR)
09420	      IA=8
09430	      IF (KDCT(IA).EQ.0) GO TO 2
09440	      CALL CATOUT(IA,IYR,1)
09450	   2  DO 1 IA=1,7
09460	      IF (KDCT(IA).EQ.0) GO TO 1
09470	      CALL CATOUT(IA,IYR,1)
09480	   1  CONTINUE
09490	      CALL TOTAL(IYR,1)
09500	      RETURN
09510	      END
09520	      SUBROUTINE WORK(IYR)
09530	      IMPLICIT INTEGER (A-N),REAL(O-Z)
09540	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
09550	      INTEGER OUNIT
09560	      INTEGER PN,QN,ZP
09570	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
09580	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
09590	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
09600	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
09610	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
09620	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
09630	C
09640	C   THIS ROUTINE DOES A DETAILED BUDGET WITH NO OUTPUT--IE IT
09650	C      GETS DATA READY FOR TOTAL, SUMMRY
09660	C
09670	      DO 1 IA=1,8
09680	   1  CALL CATOUT(IA,IYR,0)
09690	      RETURN
09700	      END
09710	      SUBROUTINE TOTAL(IYR,IPFG)
09720	      IMPLICIT INTEGER (A-N),REAL(O-Z)
09730	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
09740	      INTEGER OUNIT
09750	      INTEGER PN,QN,ZP
09760	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
09770	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
09780	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
09790	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
09800	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
09810	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
09820	      INTEGER*4 IPFG
09830	C
09840	C   THIS ROUTINE TYPES THE TOTAL OF A YEARLY BUDGET
09850	C
09860	      SO=0
09870	      TOT=0.0
09880	      SLO=0
09890	      DO 2 IA=1,8
09900	      TOT=TOT+KSUM(IA,IYR,1)
09910	      SLO=SLO+KSUM(IA,IYR,3)
09920	   2  SO=SO+KSUM(IA,IYR,2)
09930	      IF (IPFG.EQ.0) GO TO 3
09940	      IF (KSHRT.NE.0) GO TO 13
09950	      WRITE(OUNIT,1)IYR,TOT
09960	   1  FORMAT(/1H ,20(1H*),14HTOTAL FOR YEAR,I3,T60,20X,F10.0)
09970	      GO TO 10
09980	  13  WRITE(OUNIT,1001)IYR,TOT
09990	 1001 FORMAT(/1H ,20(1H*),14HTOTAL FOR YEAR,I3,T50,20X,F10.0)
10000	  10  IF (SO.EQ.0.0) GO TO 3
10010	      IF (KSHRT.NE.0) GO TO 12
10020	      WRITE(OUNIT,4)SO
10030	   4  FORMAT(1H ,20X,17HSTANFORD OVERHEAD,T60,20X,F10.0)
10040	      GO TO 11
10050	  12  WRITE(OUNIT,1004)SO
10060	 1004 FORMAT(1H ,20X,17HSTANFORD OVERHEAD,T50,20X,F10.0)
10070	  11  XTO=TOT+SO
10080	      IF (KSHRT.NE.0) GO TO 14
10090	      WRITE(OUNIT,5)XTO
10100	   5  FORMAT(1H ,20X,14HADJUSTED TOTAL,T60,20X,F10.0)
10110	      GO TO 3
10120	  14  WRITE(OUNIT,1005)XTO
10130	 1005 FORMAT(1H ,20X,14HADJUSTED TOTAL,T50,20X,F10.0)
10140	   3  KTOT(IYR,1)=TOT
10150	      KTOT(IYR,2)=SO
10160	      KTOT(IYR,3)=TOT+SO
10170	      RETURN
10180	      END
10190	      SUBROUTINE SUMMRY(IFG)
10200	      IMPLICIT INTEGER (A-N),REAL(O-Z)
10210	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
10220	      INTEGER OUNIT
10230	      INTEGER PN,QN,ZP
10240	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
10250	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
10260	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
10270	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
10280	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
10290	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
10300	      INTEGER*4 IFG
10310	C
10320	C   THIS ROUTINE TYPES A BUDGET SUMMRY FOR THE WHOLE PERIOD
10330	C
10340	      IF (IFG.EQ.1) GO TO 1
10350	      DO 2 IA=1,KLEN
10360	      CALL WORK(IA)
10370	   2  CALL TOTAL(IA,0)
10380	   1  WRITE(OUNIT,3) (HSP,IA,IA=1,KLEN)
10390	   3  FORMAT(1H1/,5H ITEM,7X,10(A1,4HYEAR,I2,5X))
10400	      IF (KDCT(8).EQ.0) GO TO 20
10410	      WRITE(OUNIT,5)(CATS(IB,8),IB=1,10),(KSUM(8,IB,1),IB=1,KLEN)
10420	  20  DO 4 IA=1,7
10430	      IF (KDCT(IA).EQ.0) GO TO 4
10440	      WRITE(OUNIT,5)(CATS(IB,IA),IB=1,10),(KSUM(IA,IB,1),IB=1,KLEN)
10450	   4  CONTINUE
10460	   5  FORMAT(/1H ,10A1,7(F10.0,2X))
10470	      WRITE(OUNIT,6)(KTOT(IB,1),IB=1,KLEN)
10480	   6  FORMAT(/1H ,5HTOTAL,5X,7(F10.0,2X))
10490	      IF (KSO(1).EQ.0) GO TO 11
10500	      WRITE(OUNIT,7)(KTOT(IB,2),IB=1,KLEN)
10510	   7  FORMAT(/1H ,9HSTAN OVHD,1X,7(F10.0,2X))
10520	      WRITE(OUNIT,8)(KTOT(IB,3),IB=1,KLEN)
10530	   8  FORMAT(/1H ,10HSTAN TOTAL,7(F10.0,2X))
10540	  11  T=0.0
10550	      ST=0.0
10560	      DO 9 IB=1,KLEN
10570	      ST=ST+KTOT(IB,3)
10580	   9  T=T+KTOT(IB,1)
10590	      WRITE(OUNIT,10)T
10600	  10  FORMAT(/1H ,23HTOTAL FOR ENTIRE PERIOD,10X,F10.0)
10610	      IF (KSO(1).EQ.0) GO TO 13
10620	      WRITE(OUNIT,12)ST
10630	  12  FORMAT(/1H ,32HSTANFORD TOTAL FOR ENTIRE PERIOD,1X,F10.0)
10640	  13  WRITE(OUNIT,14)
10650	  14  FORMAT(/////)
10660	      RETURN
10670	      END
10680	      SUBROUTINE CATOUT(ITYP,IYR,IPFG)
10690	      IMPLICIT INTEGER (A-N),REAL(O-Z)
10700	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
10710	      INTEGER OUNIT
10720	      INTEGER PN,QN,ZP
10730	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
10740	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
10750	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
10760	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
10770	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
10780	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
10790	      INTEGER*4 IPFG
10800	      INTEGER T0
10810	C
10820	C   THIS ROUTINE COMPUTES AND OUTPUTS (IF IPFG=1), THE BUDGET FOR ONE
10830	C      CATEGORY OF ITEMS FOR ONE YEAR.
10840	C
10850	      IA=0
10860	      IF (IPFG.EQ.0) GO TO 5
10870	      WRITE(OUNIT,6)(CATS(IB,ITYP),IB=1,10)
10880	   6  FORMAT(/1H ,10A1/)
10890	   5  KSUM(ITYP,IYR,1)=0.0
10900	      KSUM(ITYP,IYR,2)=0.0
10910	      KSUM(ITYP,IYR,3)=0.0
10920	      IF (ITYP.EQ.8) GO TO 100
10930	   1  IA=IA+1
10940	      IF (IA.GT.QN) GO TO 2
10950	      T0=Q(IA,3)
10960	      IF (T0.NE.ITYP) GO TO 1
10970	      IF (Q(IA,10).NE.0) GO TO 1
10980	      CALL YRCOST(ITYP,Q,400,10,IA,XC,IPFG,SC,IYR,SLO)
10990	      KSUM(ITYP,IYR,1)=KSUM(ITYP,IYR,1)+XC
11000	      KSUM(ITYP,IYR,2)=KSUM(ITYP,IYR,2)+SC
11010	      GO TO 1
11020	   2  IF (IPFG.EQ.0) RETURN
11030	      IF (KSHRT.NE.0) GO TO 13
11040	      WRITE(OUNIT,3)(CATS(IB,ITYP),IB=1,10),KSUM(ITYP,IYR,1)
11050	   3  FORMAT(/1H ,10(1H*),9HTOTAL OF ,10A1,T60,20X,F10.0)
11060	      GO TO 12
11070	  13  WRITE(OUNIT,1003)(CATS(IB,ITYP),IB=1,10),KSUM(ITYP,IYR,1)
11080	 1003 FORMAT(/1H ,10(1H*),9HTOTAL OF ,10A1,T50,20X,F10.0)
11090	  12  SALS=KSUM(ITYP,IYR,1)-KSUM(ITYP,IYR,3)
11100	      IF (KSHRT.NE.0) GO TO 11
11110	      IF (KSUM(ITYP,IYR,3).NE.0) WRITE(OUNIT,8)KSUM(ITYP,IYR,3),SALS
11120	   8  FORMAT(1H ,10X,'STAFF BENEFITS',T60,20X,F10.0/
11130	     1 1H ,10X,'SALARIES',T60,20X,F10.0)
11140	      GO TO 9
11150	  11  IF (KSUM(ITYP,IYR,3).NE.0) WRITE(OUNIT,1008)KSUM(ITYP,IYR,3),SALS
11160	 1008 FORMAT(1H ,10X,'STAFF BENEFITS',T50,20X,F10.0/
11170	     1 1H ,10X,'SALARIES',T50,20X,F10.0)
11180	   9  IF (KSO(IYR).EQ.0.OR.KSUM(ITYP,IYR,2).EQ.0) RETURN
11190	      IF (KSHRT.NE.0) GO TO 14
11200	      WRITE(OUNIT,4)KSUM(ITYP,IYR,2)
11210	   4  FORMAT(1H ,10X,17HSTANFORD OVERHEAD,T60,20X,F10.0)
11220	      RETURN
11230	  14  WRITE(OUNIT,1004)KSUM(ITYP,IYR,2)
11240	 1004 FORMAT(1H ,10X,17HSTANFORD OVERHEAD,T50,20X,F10.0)
11250	      RETURN
11260	100	IF (IPFG .EQ. 0) GO TO 10
11270		IF(KSHRT.NE.0) GO TO 101
11280		WRITE(OUNIT,1006)
11290	1006	FORMAT(63X,'%',3X,'SALARY',4X,'BEN',2X,'SAL+BEN'/)
11300		GO TO 10
11310	101	WRITE(OUNIT,1015)
11320	1015	FORMAT(53X,'%',3X,'SALARY',4X,'BEN',2X,'SAL+BEN'/)
11330	  10  IA=IA+1
11340	      IF (IA.GT.PN) GO TO 20
11350	      IF (P(IA,10).NE.0.OR.P(IA,1).EQ.0) GO TO 10
11360	      CALL YRCOST(ITYP,P,100,10,IA,XC,IPFG,SC,IYR,SLO)
11370	      KSUM(ITYP,IYR,1)=KSUM(ITYP,IYR,1)+XC
11380	      KSUM(ITYP,IYR,2)=KSUM(ITYP,IYR,2)+SC
11390	      KSUM(ITYP,IYR,3)=KSUM(ITYP,IYR,3)+SLO
11400	      GO TO 10
11410	  20  IF (IPFG.EQ.0) RETURN
11420	      SALS=KSUM(ITYP,IYR,1)-KSUM(ITYP,IYR,3)
11430		IF(KSHRT.NE.0) GO TO 25
11440		WRITE(OUNIT,2013)SALS,KSUM(ITYP,IYR,3),KSUM(ITYP,IYR,1)
11450	 2013 FORMAT(/1H ,10(1H*),6HTOTALS,48X,3F8.0)
11460	      IF (KSO(IYR).EQ.0.OR.KSUM(ITYP,IYR,2).EQ.0) RETURN
11470	      WRITE(OUNIT,2014)KSUM(ITYP,IYR,2)
11480	 2014 FORMAT(1H ,10X,17HSTANFORD OVERHEAD,T60,20X,F10.0)
11490	      RETURN
11500	25	WRITE(OUNIT,1013)SALS,KSUM(ITYP,IYR,3),KSUM(ITYP,IYR,1)
11510	 1013 FORMAT(/1H ,10(1H*),6HTOTALS,38X,3F8.0)
11520	      IF (KSO(IYR).EQ.0.OR.KSUM(ITYP,IYR,2).EQ.0) RETURN
11530	      WRITE(OUNIT,1014)KSUM(ITYP,IYR,2)
11540	 1014 FORMAT(1H ,10X,17HSTANFORD OVERHEAD,T50,20X,F10.0)
11550	      RETURN
11560	      END
11570	      SUBROUTINE PSTR(IP,IL,IC,ICL)
11580	      IMPLICIT INTEGER (A-N),REAL(O-Z)
11590	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
11600	      INTEGER OUNIT
11610	      INTEGER PN,QN,ZP
11620	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
11630	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
11640	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
11650	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
11660	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
11670	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
11680	       INTEGER*4 IC,ICL,IA
11690	C
11700	C   THIS ROUTINE WILL OUTPUT THE STRING STORED IN DAT(IP) FOR IL
11710	C      CHARACTERS INTO COLUMNS IC THRU IC+ICL
11720	C
11730	      ICX=IC
11740	      IF (IL.LE.0) RETURN
11750	      IB=0
11760	   6  IA=ICX
11770	   1  IB=IB+1
11780	      IF (IB.GT.IL) GO TO 3
11790	      CRD(IA)=DAT(IP+IB-1)
11800	      IA=IA+1
11810	      IF (IA.LE.ICX+ICL) GO TO 1
11820	      IA=IA-1
11830	      ID=IA
11840	   9  IF (ID.LE.ICX) GO TO 7
11850	      IF (CRD(ID).LT.HA.OR.CRD(ID).GT.HZ) GO TO 8
11860	      ID=ID-1
11870	      GO TO 9
11880	   8  IB=IB-(IA-ID)-1
11890	      IE=ID+1
11900	      DO 4 IG=ID,IA
11910	   4  CRD(IG)=HSP
11920	   7  ICX=ICX+120
11930	      GO TO 6
11940	   3  IA=IA-1
11950	      IF (IA.GT.CRMX) CRMX=IA
11960	      RETURN
11970	      END
11980	       SUBROUTINE CLCRD
11990	      IMPLICIT INTEGER (A-N),REAL(O-Z)
12000	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
12010	      INTEGER OUNIT
12020	      INTEGER PN,QN,ZP
12030	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
12040	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
12050	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
12060	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
12070	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
12080	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
12090	C
12100	C   THIS ROUTINE CLEARS THE I/O ARRAY 'CRD' TO SPACES
12110	C
12120	      DO 1 I=1,800
12130	   1  CRD(I)=HSP
12140	      CRMX=0
12150	      RETURN
12160	      END
12170	      SUBROUTINE PRCRD
12180	      IMPLICIT INTEGER (A-N),REAL(O-Z)
12190	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
12200	      INTEGER OUNIT
12210	      INTEGER PN,QN,ZP
12220	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
12230	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
12240	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
12250	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
12260	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
12270	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
12280	C
12290	C   THIS ROUTINE WILL TYPE THE I/O ARRAY 'CRD'
12300	C
12310	      IF (CRMX.LE.0) RETURN
12320	      WRITE(OUNIT,1)(CRD(IA),IA=1,CRMX)
12330	   1  FORMAT(1H ,8(120A1/))
12340	      CALL CLCRD
12350	      RETURN
12360	      END
12370	      SUBROUTINE FNDID(IDN,ICT)
12380	      IMPLICIT INTEGER (A-N),REAL(O-Z)
12390	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
12400	      INTEGER OUNIT
12410	      INTEGER PN,QN,ZP
12420	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
12430	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
12440	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
12450	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
12460	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
12470	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
12480	C
12490	C   THIS ROUTINE FINDS THE ID,CAT SPECIFIED IN THE INPUT LINE AS EITHER
12500	C      THE ID NUMBER OR THE CATEGORY,NAME.
12510	C
12520	      IDN=0
12530	      IF (FLD(1,2).EQ.-1) RETURN
12540	      IF (FLD(1,2).EQ.-2) GO TO 1
12550	      CALL FNDCAT(FLD(1,1),FLD(1,2),ICT)
12560	      IF (ICT.EQ.0) RETURN
12570	      CALL FNDITM(ICT,FLD(2,1),FLD(2,2),IDN)
12580	      RETURN
12590	   1  IDN=Z(FLD(1,1))
12600	      IF (IDN.GT.100) GO TO 2
12610	      ICT=8
12620	      IF (P(IDN,1).NE.0) RETURN
12630	   3  IDN=0
12640	      ICT=0
12650	      RETURN
12660	   2  IF (IDN.GT.500) GO TO 3
12670	      ICT=Q(IDN-100,3)
12680	      IF (ICT.EQ.0) GO TO 3
12690	      RETURN
12700	      END
12710	      SUBROUTINE FNDITM(CATN,NP,NL,ITM)
12720	      IMPLICIT INTEGER (A-N),REAL(O-Z)
12730	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
12740	      INTEGER OUNIT
12750	      INTEGER PN,QN,ZP
12760	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
12770	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
12780	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
12790	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
12800	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
12810	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
12820	C
12830	C   THIS ROUTINE WILL FIND THE ITEM SPECIFIED BY (NP,NL) IN CAT (CATN).
12840	C
12850	      IA=0
12860	      ITM=0
12870	      IF (NL.LE.0) RETURN
12880	      IF (CATN.EQ.8) GO TO 10
12890	   1  IA=IA+1
12900	      IF (IA.GT.QN) RETURN
12910	      IF (Q(IA,3).NE.CATN.OR.Q(IA,10).NE.0) GO TO 1
12920	      JA=Q(IA,1)
12930	      JB=Q(IA,2)
12940	      CALL SMATCH(NP,NL,JA,JB,IFG)
12950	      IF (IFG.EQ.0) GO TO 1
12960	      ITM=IA+100
12970	      RETURN
12980	  10  IA=IA+1
12990	      IF (IA.GT.PN) RETURN
13000	      IF (P(IA,10).NE.0) GO TO 10
13010	      JA=P(IA,1)
13020	      JB=P(IA,2)
13030	      CALL SMATCH(NP,NL,JA,JB,IFG)
13040	      IF (IFG.EQ.0) GO TO 10
13050	      ITM=IA
13060	      RETURN
13070	      END
13080	      SUBROUTINE FNDCAT(NP,NL,ICT)
13090	      IMPLICIT INTEGER (A-N),REAL(O-Z)
13100	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
13110	      INTEGER OUNIT
13120	      INTEGER PN,QN,ZP
13130	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
13140	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
13150	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
13160	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
13170	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
13180	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
13190	C
13200	C   THIS ROUTINE WILL FIND THE CATEGORY NUMBER SPECIFIED BY (NP,NL)
13210	C
13220	      ICT=0
13230	      NA=NL
13240	      IF (NA.GT.10) NA=10
13250	      DO 1 IA=1,8
13260	      DO 2 IB=1,NA
13270	      IF (DAT(NP+IB-1).NE.CATS(IB,IA)) GO TO 1
13280	   2  CONTINUE
13290	      ICT=IA
13300	      RETURN
13310	   1  CONTINUE
13320	      END
13330	      SUBROUTINE SMATCH(NP1,NL1,NP2,NL2,IFG)
13340	      IMPLICIT INTEGER (A-N),REAL(O-Z)
13350	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
13360	      INTEGER OUNIT
13370	      INTEGER PN,QN,ZP
13380	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
13390	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
13400	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
13410	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
13420	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
13430	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
13440	C
13450	C   THIS ROUTINE DOES A STRING MATCH ON (NP1,NL1) VS (NP2,NL2)
13460	C
13470	      IFG=0
13480	      IF (NL2.LT.NL1) RETURN
13490	      DO 1 IA=1,NL1
13500	      IF (DAT(NP1+IA-1).NE.DAT(NP2+IA-1)) RETURN
13510	   1  CONTINUE
13520	      IFG=1
13530	      RETURN
13540	      END
13550	      SUBROUTINE SVDATA
13560	      IMPLICIT INTEGER (A-N),REAL(O-Z)
13570	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
13580	      INTEGER OUNIT
13590	      INTEGER PN,QN,ZP
13600	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
13610	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
13620	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
13630	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
13640	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
13650	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
13660	C
13670	C   THIS ROUTINE WILL WRITE THE CURRENT DATA TO UNIT 21
13680	C
13690	      TYPE 100
13700	  100 FORMAT(' NAME THE NEW BUDGET DATA FILE:')
13710	      OPEN(UNIT=21,ACCESS='SEQOUT',MODE='ASCII',DIALOG)
13720	      CALL CLCRD
13730	      WRITE(21,1)
13740	   1  FORMAT(5HTITLE)
13750	      CALL SVSTR(KTITP,KTITL,0)
13760	      CALL SVCRD
13770	      IA=KSTRT/100
13780	      IB=KSTRT-IA*100
13790	      WRITE(21,2) IB,IA
13800	   2  FORMAT(6HSTART,,I2,1H,,I5)
13810	      IA=KEND/100
13820	      IB=KEND-IA*100
13830	      WRITE(21,3) IB,IA
13840	   3  FORMAT(5HTHRU,,I2,1H,,I5)
13850	      IB=8
13860	      IF (KDCT(IB).EQ.0) GO TO 7
13870	      CALL SVCAT(IB)
13880	      IA=0
13890	   6  IA=IA+1
13900	      IF (IA.GT.PN) GO TO 7
13910	      IF (P(IA,1).EQ.0.AND.P(IA,5).EQ.0.AND.P(IA,6).EQ.0) GO TO 6
13920	      CALL SVPEOP(IA)
13930	      GO TO 6
13940	   7  DO 8 IB=1,7
13950	      IF (KDCT(IB).EQ.0) GO TO 8
13960	      CALL SVCAT(IB)
13970	      IA=0
13980	  10  IA=IA+1
13990	      IF (IA.GT.QN) GO TO 8
14000	      IF (Q(IA,3).NE.IB) GO TO 10
14010	      CALL SVITEM(IA)
14020	      GO TO 10
14030	   8  CONTINUE
14040	      WRITE(21,11)(KSO(IA),IA=1,KLEN)
14050	  11  FORMAT(9HSTAN-OVHD,10(1H,,F6.2))
14060	      WRITE(21,12)
14070	  12  FORMAT(3HEND)
14080	      CLOSE(UNIT=21)
14090	      TYPE13
14100	  13  FORMAT(1H0,'CURRENT DATA SAVED')
14110	      RETURN
14120	      END
14130	      SUBROUTINE SVPEOP(I)
14140	      IMPLICIT INTEGER (A-N),REAL(O-Z)
14150	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
14160	      INTEGER OUNIT
14170	      INTEGER PN,QN,ZP
14180	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
14190	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
14200	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
14210	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
14220	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
14230	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
14240	C
14250	C   THIS ROUTINE SAVES DATA ON PERSON I
14260	C
14270	      IF (P(I,10).NE.0) GO TO 1
14280	      IA=P(I,1)
14290	      IB=P(I,2)
14300	      CALL SVSTR(IA,IB,1)
14310	   2  IA=P(I,3)
14320	      IB=P(I,4)
14330	   3  CALL SVSTR(IA,IB,1)
14340	      CALL SVNUM(P(I,5),100.0,1)
14350	      CALL SVNUM(P(I,6),-1.0,1)
14360	      CALL SVNUM(P(I,7),1.0,1)
14370	      XA=KLEN
14380	      CALL SVNUM(P(I,8),XA,1)
14390	      CALL SVNUM(P(I,9),9.0,0)
14400	      CALL SVCRD
14410	      RETURN
14420	   1  IA=0
14430	      IB=0
14440	      CALL SVSTR(IA,IB,1)
14450	      IF (P(I,3).NE.P(I-1,3)) GO TO 2
14460	      GO TO 3
14470	      END
14480	      SUBROUTINE SVITEM(I)
14490	      IMPLICIT INTEGER (A-N),REAL(O-Z)
14500	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
14510	      INTEGER OUNIT
14520	      INTEGER PN,QN,ZP
14530	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
14540	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
14550	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
14560	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
14570	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
14580	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
14590	C
14600	C   THIS ROUTINE SAVES ITEM NUMBER I
14610	C
14620	      IB=0
14630	      IA=0
14640	      IF (Q(I,10).NE.0) GO TO 1
14650	      IA=Q(I,1)
14660	      IB=Q(I,2)
14670	   1  CALL SVSTR(IA,IB,1)
14680	      CALL SVNUM(Q(I,5),1.0,1)
14690	      CALL SVNUM(Q(I,6),-1.0,1)
14700	      CALL SVNUM(Q(I,7),1.0,1)
14710	      XA=KLEN
14720	      CALL SVNUM(Q(I,8),XA,0)
14730	      CALL SVCRD
14740	      RETURN
14750	      END
14760	      SUBROUTINE SVSTR(NP,NL,NFG)
14770	      IMPLICIT INTEGER (A-N),REAL(O-Z)
14780	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
14790	      INTEGER OUNIT
14800	      INTEGER PN,QN,ZP
14810	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
14820	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
14830	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
14840	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
14850	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
14860	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
14870	      INTEGER*4 NFG
14880	C
14890	C   THIS ROUTINE MOVES A STRING FOR OUTPUTING DATA
14900	C
14910	      IB=NP-1
14920	      IF (NL.LE.0) GO TO 7
14930	      IF (NL+CRMX.GT.60+10*NFG) GO TO 3
14940	      DO 2 IA=1,NL
14950	      IF (DAT(IB+IA).EQ.HCMA) GO TO 3
14960	   2  CONTINUE
14970	      NCFG=0
14980	      GO TO 4
14990	   3  NCFG=1
15000	      CRMX=CRMX+1
15010	      CRD(CRMX)=HSP
15020	      CRMX=CRMX+1
15030	      CRD(CRMX)=HDIV
15040	      CRMX=CRMX+1
15050	      CRD(CRMX)=HMUL
15060	   4  IA=0
15070	   5  IA=IA+1
15080	      IF (IA.GT.NL) GO TO 7
15090	      IF (CRMX.GE.69) CALL SVCRD
15100	      CRMX=CRMX+1
15110	      CRD(CRMX)=DAT(IB+IA)
15120	      GO TO 5
15130	   7  IF (NCFG.EQ.0) GO TO 8
15140	      IF (CRMX.GT.60.AND.NFG.EQ.1) CALL SVCRD
15150	      CRMX=CRMX+1
15160	      CRD(CRMX)=HMUL
15170	      CRMX=CRMX+1
15180	      CRD(CRMX)=HDIV
15190	   8  IF (NFG.EQ.0) RETURN
15200	      CRMX=CRMX+1
15210	      CRD(CRMX)=HCMA
15220	      RETURN
15230	      END
15240	      SUBROUTINE SVNUM(XY,XX,NFG)
15250	      IMPLICIT INTEGER (A-N),REAL(O-Z)
15260	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
15270	      INTEGER OUNIT
15280	      INTEGER PN,QN,ZP
15290	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
15300	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
15310	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
15320	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
15330	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
15340	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
15350	      INTEGER*4 NFG
15360	      REAL AINT
15370	      X=XY
15380	      IF (X.EQ.XX) GO TO 20
15390	      IF (X.LE.0.0) GO TO 10
15400	      Y=1000000
15410	      IC=0
15420	   2  IA=X/Y
15430	      IF (IA.EQ.0.AND.IC.EQ.0) GO TO 1
15440	      X=X-IA*Y
15450	      IC=1
15460	      IB=H0+IA*(2**29)
15470	      CRMX=CRMX+1
15480	      CRD(CRMX)=IB
15490	   1  Y=Y/10.
15500	      IF (Y.GE.1) GO TO 2
15510	   3  X=AINT(100.0*X+0.00001)
15520	      IF (X.EQ.0.0) GO TO 20
15530	      CRMX=CRMX+1
15540	      CRD(CRMX)=HDOT
15550	      IA=X/10
15560	      CRMX=CRMX+1
15570	      CRD(CRMX)=H0+IA*(2**29)
15580	      IA=X-IA*10
15590	      CRMX=CRMX+1
15600	      CRD(CRMX)=H0+IA*(2**29)
15610	  20  IF (NFG.EQ.0) RETURN
15620	      CRMX=CRMX+1
15630	      CRD(CRMX)=HCMA
15640	      RETURN
15650	  10  CRMX=CRMX+1
15660	      CRD(CRMX)=H0
15670	      GO TO 3
15680	      END
15690	      SUBROUTINE SVCRD
15700	      IMPLICIT INTEGER (A-N),REAL(O-Z)
15710	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
15720	      INTEGER OUNIT
15730	      INTEGER PN,QN,ZP
15740	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
15750	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
15760	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
15770	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
15780	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
15790	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
15800	C
15810	C   OUTPUTS THE CURRENT OUTPUT CARD
15820	C
15830	      WRITE(21,1)(CRD(I),I=1,CRMX)
15840	   1  FORMAT(80A1)
15850	      CALL CLCRD
15860	      RETURN
15870	      END
15880	      SUBROUTINE SVCAT(I)
15890	      IMPLICIT INTEGER (A-N),REAL(O-Z)
15900	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
15910	      INTEGER OUNIT
15920	      INTEGER PN,QN,ZP
15930	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
15940	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
15950	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
15960	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
15970	      COMMON NCMDS,NCMD,CMD(8,35),CATS(10,10),CRD(800),CRMX
15980	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
15990	C
16000	C   THIS ROUTINE OUTPUTS HEADER OF CATEGORY I
16010	C
16020	      WRITE(21,2)(CATS(IA,I),IA=1,8),(KINC(I,IA),IA=1,KLEN)
16030	   2  FORMAT(8A1/8HANUL-INC,10(1H,,F6.2))
16040	      IF (I.NE.8) RETURN
16050	      WRITE(21,4) (KOVHD(IA),IA=1,KLEN)
16060	   4  FORMAT(8HSAL-OVHD,10(1H,,F6.2))
16070	      RETURN
16080	      END
16090	      BLOCK DATA
16100	      IMPLICIT INTEGER (A-N),REAL(O-Z)
16110	      REAL KINC(10,10),KOVHD(10),KSO(10),KTOT(10,3),KSUM(10,10,3),FLOAT
16120	      INTEGER OUNIT
16130	      INTEGER PN,QN,ZP
16140	      COMMON KINC,KOVHD,KSO,KSUM,KTOT,IUNIT,OUNIT,KRND(10,10),KDCT(10)
16150	      COMMON P(100,10),Q(400,10),Z(50),KTFLD,KAFLD,KBFLD,KSHRT
16160	      COMMON CMDN,FLDC,FLD(20,2),PN,QN,ZP,DP,DAT(10000)
16170	      COMMON KTITP,KTITL,KSTRT,KEND,KMNTH,KLEN
16180	      COMMON NCMDS,NCMD,CMD(8,20),CCMD(8,15),CATS(10,10),CRD(800),CRMX
16190	      COMMON HSP,HCMA,HDIV,HMUL,H0,H9,HDOT,HA,HZ
16200	      DATA NCMDS,NCMD/34,18/
16210	      DATA CMD/1HT,1HI,1HT,1HL,1HE,3*0,1HD,1HA,1HT,1HE,1HS,3*0,
16220	     1 1HS,1HT,1HA,1HR,1HT,3*0,1HT,1HH,1HR,1HU,4*0,
16230	     2 1HP,1HE,1HO,1HP,1HL,1HE,2*0,1HC,1HO,1HN,1HS,1HU,1HL,1HT,1HA,
16240	     3 1HE,1HQ,1HU,1HI,1HP,1HM,1HE,1HN,1HS,1HU,1HP,1HP,1HL,1HI,1HE,1HS,
16250	     4 1HT,1HR,1HA,1HV,1HE,1HL,2*0,1HP,1HA,1HT,1HI,1HE,1HN,1HT,0,
16260	     5 1HA,1HL,1HT,1HE,1HR,1HA,1HT,1HI,1HO,1HT,1HH,1HE,1HR,3*0,
16270	     6 1HA,1HN,1HU,1HL,1H-,1HI,1HN,1HC,1HS,1HA,1HL,1H-,1HO,1HV,1HH,1HD,
16280	     7 1HS,1HT,1HA,1HN,1H-,1HO,1HV,1HH,1HE,1HN,1HD,5*0,
16290	     8 1HR,1HO,1HU,1HN,1HD,3*0,8*0,
16300	     9 8*0,8*0/
16310	      DATA (CMD(I,18),I=1,8)/1HS,1HT,1HA,1HF,1HF,1H-,1HB,1HE/
16320	      DATA CCMD/1HR,1HE,1HP,1HL,1HA,1HC,1HE,0,1HA,1HD,1HD,5*0,
16330	     1 1HD,1HE,1HL,1HE,1HT,1HE,2*0,1HM,1HO,1HD,1HI,1HF,1HY,2*0,
16340	     2 1HD,1HE,1HT,1HA,1HI,1HL,2*0,1HS,1HU,1HM,1HM,1HA,1HR,1HY,0,
16350	     3 1HT,1HO,1HT,1HA,1HL,3*0,1HC,1HA,1HT,1HE,1HG,1HO,1HR,1HY,
16360	     4 1HI,1HT,1HE,1HM,4*0,1HS,1HT,1HO,1HP,4*0,
16370	     5 1HA,1HL,1HL,5*0,1HS,1HA,1HV,1HE,4*0,
16380	     6 1HL,1HI,1HS,1HT,4*0,1HD,1HI,1HV,1HE,1HR,1HT,2*0,
16390	     7 8*0/
16400	      DATA CATS/1HC,1HO,1HN,1HS,1HU,1HL,1HT,1HA,1HN,1HT,
16410	     1 1HE,1HQ,1HU,1HI,1HP,1HM,1HE,1HN,1HT,1H ,
16420	     2 1HS,1HU,1HP,1HP,1HL,1HI,1HE,1HS,2*1H ,
16430	     3 1HT,1HR,1HA,1HV,1HE,1HL,4*1H ,1HP,1HA,1HT,1HI,1HE,1HN,1HT,3*1H ,
16440	     4 1HA,1HL,1HT,1HE,1HR,1HA,1HT,1HI,1HO,1HN,
16450	     5 1HO,1HT,1HH,1HE,1HR,5*1H ,
16460	     6 1HP,1HE,1HO,1HP,1HL,1HE,4*1H ,
16470	     7 10*1H ,10*1H /
16480	      DATA HSP,HCMA,HDIV,HMUL/1H ,1H,,1H/,1H*/
16490	      DATA H0,H9,HDOT,HA,HZ/1H0,1H9,1H.,1HA,1HZ/
16500	      DATA KINC,KOVHD,KSO,KTOT/150*0.0/
16510	      DATA KRND/100*1/
16520	      DATA P,Q/5000*0.0/
16530	      DATA KDCT/10*0/
16540	      END
